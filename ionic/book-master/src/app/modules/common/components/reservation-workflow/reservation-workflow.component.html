<ion-item *ngIf="currentStep !== 'provider'" lines="none" class="workflow-nav">
  <ion-button class="back-button" fill="clear" (click)="goBack()" [disabled]="!canGoBack" aria-label="Step precedente">
    <ion-icon name="chevron-back-outline"></ion-icon>
  </ion-button>

  <ion-label class="ion-text-center">{{ stepLabel }}</ion-label>

  <div *ngIf="currentStep === 'slots'" class="workflow-date-picker">
    <ion-icon name="calendar-outline" aria-hidden="true"></ion-icon>
    <input class="workflow-date-input"
           type="date"
           [value]="selectedCalendarDate"
           [min]="todayIsoDate"
           (change)="onCalendarDateChange($event)">
  </div>
</ion-item>

<app-providers-list *ngIf="currentStep === 'provider'" (selected)="providerSelected($event)"></app-providers-list>

<app-object-profile *ngIf="currentStep === 'service' && currentProvider"
                    [view]="providerInfoView"
                    [object]="currentProvider"></app-object-profile>

<app-services-list *ngIf="currentStep === 'service' && currentProvider"
                   [provider]="currentProvider"
                   [selectable]="true"
                   [closable]="false"
                   (selected)="serviceSelected($event.service)"></app-services-list>

<div *ngIf="currentStep === 'slots' && currentService" style="display: flex">
  <ion-list *ngFor="let slotDay of slots | keyvalue; let lastDay = last; let firstDay = first">
    <ion-item>
      <ion-icon *ngIf="firstDay && isNotToday(slotDay.key)" name="arrow-back-circle-outline" (click)="update(-1)"></ion-icon>

      <span>{{ slotDay.key | date: 'EEEEEE dd/MM'}}</span>

      <ion-icon *ngIf="lastDay" name="arrow-forward-circle-outline" (click)="update(1)"></ion-icon>
    </ion-item>

    <ion-item *ngFor="let slot of slotDay.value; let j = index" lines="full" class="ion-text-center">
      <ion-button (click)="addReservation(slotDay.key, j)"
                  [disabled]="!hasRequiredConsecutiveSlots(slotDay.key, j)"
                  style="width: 100%">
        <ion-label>{{ slot }}</ion-label>
      </ion-button>
    </ion-item>
  </ion-list>
</div>

<div *ngIf="currentStep === 'summary' && reservationPreview" class="reservation-summary">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Riepilogo prenotazione</ion-card-title>
    </ion-card-header>

    <app-object-profile [view]="reservationConsultView" [object]="reservationPreview"></app-object-profile>
  </ion-card>

  <ion-button expand="block" color="primary" (click)="confirmReservation()">
    Conferma prenotazione
  </ion-button>
</div>
