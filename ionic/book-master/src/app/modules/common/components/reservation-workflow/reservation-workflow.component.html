<ion-item *ngIf="currentStep !== 'provider'" lines="none" class="workflow-nav">
  <ion-button class="back-button"
              fill="clear"
              (click)="goBack()"
              [disabled]="!canGoBack"
              [attr.aria-label]="'reservationWorkflow.previousStepAria' | t">
    <ion-icon name="chevron-back-outline"></ion-icon>
  </ion-button>

  <ion-label class="ion-text-center">{{ stepLabel }}</ion-label>
</ion-item>

<app-providers-list *ngIf="currentStep === 'provider'" (selected)="providerSelected($event)"></app-providers-list>

<app-object-profile *ngIf="currentStep === 'service' && currentProvider"
                    [view]="providerInfoView"
                    [object]="currentProvider"></app-object-profile>

<app-services-list *ngIf="currentStep === 'service' && currentProvider"
                   [provider]="currentProvider"
                   [selectable]="true"
                   [closable]="false"
                   (selected)="serviceSelected($event.service)"></app-services-list>

<ion-item *ngIf="currentStep === 'slots' && currentService && providerClosedWeekDays.length > 0" lines="none">
  <ion-label>{{ 'reservationWorkflow.closedDaysInfo' | t:{ days: providerClosedDaysLabel } }}</ion-label>
</ion-item>
<ion-item *ngIf="currentStep === 'slots' && currentService && providerClosedDatesIso.length > 0" lines="none">
  <ion-label>{{ 'reservationWorkflow.closedDatesInfo' | t:{ dates: providerClosedDatesLabel } }}</ion-label>
</ion-item>

<app-status-calendar *ngIf="currentStep === 'slots' && currentService"
                     [month]="currentCalendarMonth"
                     [monthLabel]="currentMonthLabel"
                     [weekDayKeys]="weekDayKeys"
                     [selectedDateIso]="selectedCalendarDate"
                     [todayIsoDate]="todayIsoDate"
                     [dotLevelsByDate]="calendarDotLevelsByDate"
                     [disabledWeekDays]="providerClosedWeekDays"
                     [disabledDatesIso]="providerClosedDatesIso"
                     [canGoToPreviousMonth]="canGoToPreviousMonth"
                     (monthChange)="changeMonth($event)"
                     (daySelected)="selectCalendarDay($event)"></app-status-calendar>

<div *ngIf="currentStep === 'slots' && currentService" style="display: flex">
  <ion-list *ngFor="let slotDay of slots | keyvalue">
    <ion-item>
      <span>{{ slotDay.key | date: 'EEEEEE dd/MM':'':currentLocale }}</span>
    </ion-item>

    <ion-item *ngFor="let slot of slotDay.value; let j = index" lines="full" class="ion-text-center">
      <ion-button (click)="addReservation(slotDay.key, j)"
                  [disabled]="!hasRequiredConsecutiveSlots(slotDay.key, j)"
                  style="width: 100%">
        <ion-label>{{ slot }}</ion-label>
      </ion-button>
    </ion-item>
  </ion-list>
</div>

<div *ngIf="currentStep === 'summary' && reservationPreview" class="reservation-summary">
  <ion-card>
    <app-object-profile [view]="reservationConsultView" [object]="reservationPreview"></app-object-profile>
  </ion-card>

  <ion-button expand="block" color="primary" (click)="confirmReservation()">
    {{ 'reservationWorkflow.confirmBooking' | t }}
  </ion-button>
</div>
